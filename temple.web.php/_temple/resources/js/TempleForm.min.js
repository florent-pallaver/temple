
$(document).ajaxError(function(c,d,a,b){alert("An error occured while processing the request.\n\nCause: Error "+d.status+" - "+b)});String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};function TempleForm(a){this.form=a;var b=$(a);this.submits=b.find('*[type="submit"]');this.clicked=b.find('button[type="submit"]._clicked')}TempleForm.SUCCESS_STATUS=3;TempleForm.prototype.submitDone=function(a){var h=$(this.form);h.find(".form-group").removeClass("has-error");h.find("._temple_feedback").remove();TempleAlert.showAll(a.messages);if(a.status===TempleForm.SUCCESS_STATUS){var g=h.data();var d=g.onSuccess;if(d&&(typeof window[d]==="function")){window[d](g,a.data)}if(a.goTo){window.location.replace(a.goTo)}else{if(a.reload){if(!window.location.reload()){}}else{if(a.resetForm){this.form.reset()}h.find('input[type="password"]').val("")}}}else{var b=a.feedbacks||[];var e=Object.keys(b);if(e&&e.length){for(var c=0;c<e.length;c++){var j=h.find('[name="'+e[c]+'"]');j.closest(".form-group").addClass("has-error");j.after('<small class="help-block _temple_feedback">'+b[e[c]]+"</small>")}this.form[e[0]].focus()}}};TempleForm.prototype.submitAlways=function(){if(this.clicked.length){this.clicked.removeClass("_clicked");this.clicked[0].blur()}this.submits.removeAttr("disabled")};TempleForm.prototype.submit=function(){this.submits.attr("disabled","disabled");var a=new FormData(this.form);if(this.clicked.length){a.append(this.clicked.attr("name"),this.clicked.val())}$.ajax($(this.form).attr("action"),{type:"POST",dataType:"json",cache:false,context:this,data:a,contentType:false,processData:false}).done(this.submitDone).always(this.submitAlways)};TempleForm.spySubmits=function(){$('button[type="submit"]').on("click",function(a){if(!$(this).hasClass("_confirm")||confirm("Are you sure you want to do this action?")){$(this).addClass("_clicked")}else{this.blur();a.preventDefault()}});$("form._temple-form").on("submit",function(a){a.preventDefault();new TempleForm(this).submit()})};TempleForm.spySubmits();