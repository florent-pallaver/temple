
$(document).ajaxError(function(c,d,a,b){alert("An error occured while processing the request.\n\nCause: Error "+d.status+" - "+b)});String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};function TempleForm(a){this.form=a;var b=$(a);this.submits=b.find('*[type="submit"]');this.clicked=b.find('button[type="submit"]._clicked')}TempleForm.SUCCESS_STATUS=3;TempleForm.prototype.submitDone=function(k){var c=$(this.form);c.find(".form-group").removeClass("has-error");c.find("._temple_feedback").remove();TempleAlert.showAll(k.messages);if(k.status===TempleForm.SUCCESS_STATUS){var a=c.data();var d=a.onSuccess;if(d&&(typeof window[d]==="function")){window[d](a,k.data)}if(k.goTo){window.location.replace(k.goTo)}else{if(k.reload){if(!window.location.reload()){}}else{if(k.resetForm){this.form.reset()}c.find('input[type="password"]').val("")}}}else{var j=k.feedbacks||[];var g=Object.keys(j);if(g&&g.length){for(var b=0;b<g.length;b++){var e=c.find('[name="'+g[b]+'"]');e.closest(".form-group").addClass("has-error");var h=e.closest(".input-group");if(h.length){e=h}e.after('<small class="help-block _temple_feedback">'+j[g[b]]+"</small>")}if(this.form[g[0]]&&typeof this.form[g[0]].focus==="function"){this.form[g[0]].focus()}}}};TempleForm.prototype.submitAlways=function(){if(this.clicked.length){this.clicked.removeClass("_clicked");this.clicked[0].blur()}this.submits.removeAttr("disabled")};TempleForm.prototype.submit=function(){this.submits.attr("disabled","disabled");var a=new FormData(this.form);if(this.clicked.length){a.append(this.clicked.attr("name"),this.clicked.val())}$.ajax($(this.form).attr("action"),{type:"POST",dataType:"json",cache:false,context:this,data:a,contentType:false,processData:false}).done(this.submitDone).always(this.submitAlways)};TempleForm.CONFIRM_MESSAGE="Are you sure you want to do this action?";TempleForm.spySubmits=function(){$('input[type="file"][maxlength]').on("change",function(){var b=$(this).closest(".form-group");var a=true;if(this.files.length){a=this.files[0].size<=$(this).attr("maxlength");console.log(a?"OK":"KO")}if(a){b.removeClass("has-error")}else{b.addClass("has-error")}});$('button[type="submit"]').on("click",function(a){if(!$(this).hasClass("_confirm")||confirm(TempleForm.CONFIRM_MESSAGE)){$(this).addClass("_clicked")}else{this.blur();a.preventDefault()}});$("form._temple-form").on("submit",function(a){a.preventDefault();new TempleForm(this).submit()})};TempleForm.spySubmits();